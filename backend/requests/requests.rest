@baseUrl = http://localhost:8000
@appId = 1

### ============================================================================
### 0. APP CREATION (Run this first!)
### ============================================================================

### Create the Main App
# This initializes the app so you have an ID (usually 1) to attach pages to.
POST {{baseUrl}}/api/app/
Content-Type: application/json

{
  "app_name": "My Solar Calc"
}

### ============================================================================
### 1. PAGE CONFIGURATION (The "Nested Write" Endpoint)
### ============================================================================

### Create Page 1 (Energy Basics)
# This page has 1 Input (X) and NO calculations.
POST {{baseUrl}}/apps/{{appId}}/pages/
Content-Type: application/json

{
  "title": "Energy Basics",
  "description": "Tell us about your monthly bill.",
  "image_url": "http://localhost:8000/static/solar-1.jpg",
  "order_index": 0,
  "inputs": [
    {
      "variable_name": "X",
      "placeholder": "Monthly Bill ($)",
      "input_type": "number"
    }
  ],
  "calculations": [
    {
      "output_name": "C",
      "formula": "X-2",
      "unit": "X ten iki çıkar"
    }
  ]
}

### Create Page 2 (Home Details & Calculations)
# This page has 2 Inputs (Y, Z) AND defines the Formulas (A, B).
POST {{baseUrl}}/apps/{{appId}}/pages/
Content-Type: application/json

{
  "title": "Home Details",
  "description": "Enter your roof dimensions.",
  "image_url": "http://localhost:8000/static/solar-2.jpg",
  "order_index": 1,
  "calculations": [
    {
      "output_name": "A",
      "formula": "2 * X",
      "unit": "kWh"
    },
    {
      "output_name": "B",
      "formula": "6 * X / 3",
      "unit": "meters"
    }

  ]
}

### ============================================================================
### 2. RETRIEVAL & DELETION
### ============================================================================

### Get Full App Configuration
# This checks if your "GET" is correctly returning the nested tree structure.
GET {{baseUrl}}/api/app/

### Get Full App Configuration
# This checks if your "GET" is correctly returning the nested tree structure.
GET {{baseUrl}}/api/app/{{appId}}/

###
DELETE  {{baseUrl}}/api/app/{{appId}}/


### Delete a Page
# Replace '1' with an actual page ID returned from the creation step
DELETE {{baseUrl}}/apps/{{appId}}/pages/1

### ============================================================================
### 5. BULK UPDATE (The Structure Endpoint)
### ============================================================================

### Update App Structure (Update, Create, and Delete in one go)
PUT {{baseUrl}}/api/app/{{appId}}/structure
Content-Type: application/json

{
  "app_name": "My Solar Calc (v2)",
  "pages": [
    {
      "id": 1,
      "title": "Monthly Usage (Updated)",
      "description": "We updated this page title!",
      "image_url": "http://localhost:8000/static/solar-1.jpg",
      "order_index": 0,
      "inputs": [
        {
          "id": 1, 
          "variable_name": "Bill", 
          "placeholder": "Monthly Bill ($)",
          "input_type": "number"
        },
        {
          "variable_name": "Roof_Area", 
          "placeholder": "Roof Size (m2)", 
          "input_type": "number"
        }
      ],
      "calculations": [] 
    },
    {
      "title": "Results Page (New)",
      "description": "This page was just created.",
      "image_url": "",
      "order_index": 1,
      "inputs": [],
      "calculations": [
        {
          "output_name": "Total_Savings",
          "formula": "Bill * 12",
          "unit": "$"
        }
      ]
    }
  ]
}



### ============================================================================
### 4. IMAGE UPLOAD
### ============================================================================

### Upload an Image
# You will need to select a file from your computer when prompted
# or specify the path explicitly if your REST client settings require it.
POST {{baseUrl}}/upload
Content-Type: multipart/form-data; boundary=boundary

--boundary
Content-Disposition: form-data; name="file"; filename="solar-panel.jpg"
Content-Type: image/jpeg

< ./solar-panel.jpg
--boundary--